---
- hosts: websever
  become: yes
  vars:
    build_number: '{{ BUILD_NUMBER }}'
  tasks:
      
    - name: Login to JFrog
  shell: echo "{{ jfrog_token }}" | docker login -u "{{ jfrog_user }}" --password-stdin trialzy20o8.jfrog.io
  vars:
    jfrog_user: "harshithagreeshma21.com"
    jfrog_token: "{{ lookup('env','JFROG_TOKEN') }}"
  
    
    - name: pull an image
      shell: docker pull trialzy20o8.jfrog.io/sample-war-app/sample_docker_image_with_war_deploy:v1.0-{{ build_number }}

    - name: remove container
      shell: docker rm -f devopsAppDeploy
        
    - name: create a application container
      shell: docker run -id --name devopsAppDeploy -p 8111:8080 trialzy20o8.jfrog.io/docker/sample_docker_image_with_war_deploy:v1.0-{{ build_number }}
 
   
